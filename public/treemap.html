<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('#chart_div').height(screen.height).width(screen.width);
      });
      google.charts.load('current', {'packages':['treemap']});
      google.charts.setOnLoadCallback(setup);

      function setup() {
        getDataAndDraw();
        setInterval(getDataAndDraw, 120000);
      }

      function getDataAndDraw() {
        console.log('Getting fresh data from server...');
        $.get('/panel/treemap', function(data, status) {
        if(status == 'success')
          drawChart(data);
        else
          console.error('Failed to get fresh trends data from server. Status: ' + status);
        });
      }

      function drawChart(trendsData) {
        var baseData = [
          ['Location', 'Parent', 'Number of wins', 'Hotness (color)'],
          ['Trend-O-Meter', null, 0, 0],
        ];
        var dataTable = google.visualization.arrayToDataTable(baseData.concat(trendsData));

        tree = new google.visualization.TreeMap(document.getElementById('chart_div'));

        tree.draw(dataTable, {
          minColor: '#6f2868',
          midColor: '#34ad3e',
          maxColor: '#ff3400',
          headerHeight: 0,
          fontColor: 'white',
          fontFamily: 'Open Sans',
          fontSize: 20,
          showScale: false
        });
      }
    </script>
  </head>
  <body>
    <div id="chart_div"></div>
  </body>
</html>
